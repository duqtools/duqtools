# The `duqtools` config file

UQ run settings are configured using a yaml configuration file in the project directory. By default it is named `duqtools.yaml`. You can specify another path for it using the -c/--config option (see `duqtools help` or the [cli](/command-line-interface/)).

As a minimum, this configuration file must define the root workspace and the system to use (see below). All other settings are (in principle) optional.


## Starting from scratch

To help initialize a starting config to modify, you can run [`duqtools init`](/command-line-interface/#init).

Check out the different subpages of this section that explain the different parts of the config.

- [create](/config/create)
- [submit](/config/submit)
- [status](/config/status)
- [workspace](/config/introduction/#workspace)
- [system](/config/introduction/#defining-the-system)
- [variables](/config/introduction/#specifying-variables)

### Example config file

Below is an example config file generated by `duqtools init`.

```yaml title="duqtools.yaml"
workspace:
  root: /pfs/work/username/jetto/runs/
system: jetto
quiet: false
create:
  template: /pfs/work/username/jetto/runs/duqtools_template
  data:
    imasdb: test
    run_in_start_at: 7000
    run_out_start_at: 8000
  dimensions:
  - operator: multiply
    scale_to_error: false
    values: [1.1, 1.2, 1.3]
    variable: t_i_average
  - operator: multiply
    scale_to_error: false
    values: [1.1, 1.2, 1.3]
    variable: zeff
  - operator: copyto
    scale_to_error: false
    values: [296.0, 297.0]
    variable: major_radius
  sampler:
    method: latin-hypercube
    n_samples: 3
merge:
  data: runs.yaml
  template:
    db: jet
    run: 1
    shot: 94785
    user: docs
  output:
    db: jet
    run: 9999
    shot: 94785
  plan:
  - data_variables:
    - t_i_average
    - zeff
    grid_variable: rho_tor_norm
    time_variable: time
status:
  in_file: jetto.in
  msg_completed: 'Status : Completed successfully'
  msg_failed: 'Status : Failed'
  msg_running: 'Status : Running'
  out_file: jetto.out
  status_file: jetto.status
submit:
  submit_command: sbatch
  submit_script_name: .llcmd
```


## Workspace

{{ schema_WorkDirectoryModel['description'] }}

{% for name, prop in schema_WorkDirectoryModel['properties'].items() %}
`{{ name }}`
: {{ prop['description'] }}
{% endfor %}

For example:

```yaml title="duqtools.yaml"
workspace:
  root: /pfs/work/username/jetto/runs/
```


## Defining the system

Currently there are two systems available. They are distinguished by specifying the `system` field.

```yaml title="duqtools.yaml"
system: jetto
```

### jetto, jetto-duqtools

{{ schema_JettoDuqtoolsSystem['description'] }}

### jetto-pythontools

{{ schema_JettoPythonToolsSystem['description'] }}

### dummy

{{ schema_DummySystem['description'] }}

## Specifying Variables

To access different variables, duqtools must know how to navigate the IMAS specification. The variable lookup table maps variable names, and specifies their dimensions. The lookup file is stored in yaml format, typicall with the name `variables.yaml`. Duqtools includes a default [variables.yaml](https://github.com/CarbonCollective/fusion-dUQtools/blob/main/src/duqtools/data/variables.yaml), but you can also define your own.

Duqtools looks for the `variables.yaml` file in the following locations, in this order:

1. Via environment variable `$DUQTOOLS_VARIABLES`
2. If not defined, look for `$XDG_CONFIG_HOME/duqtools/variables.yaml`
3. If `$XDG_CONFIG_HOME` is not defined, look for `$HOME/.config/duqtools/variables.yaml`
4. If not defined, fall back to the included [variables.yaml](https://github.com/CarbonCollective/fusion-dUQtools/blob/main/src/duqtools/data/variables.yaml), which contains a sensible list of defaults.


### IDS variables

{{ schema_IDSVariableModel['description'] }}

{% for name, prop in schema_IDSVariableModel['properties'].items() %}
`{{ name }}`
: {{ prop['description'] }}
{% endfor %}

### Jetto variables

{{ schema_JettoVariableModel['description'] }}

{% for name, prop in schema_JettoVariableModel['properties'].items() %}
`{{ name }}`
: {{ prop['description'] }}
{% endfor %}


Example:

```yaml title="variables.yaml"
variables:
- name: rho_tor_norm
  ids: core_profiles
  path: profiles_1d/*/grid/rho_tor_norm
  dims: [time, x]
  type: IDS-variable
- name: t_i_average
  ids: core_profiles
  path: profiles_1d/*/t_i_average
  dims: [time, x]
  type: IDS-variable
- name: zeff
  ids: core_profiles
  path: profiles_1d/*/zeff
  dims: [time, x]
  type: IDS-variable
- name: time
  ids: core_profiles
  path: time
  dims: [time]
  type: IDS-variable
- name: major_radius
  type: jetto-variable
  lookup:
    name: major_radius
    doc: Reference major radius (R0)
    type: float
    keys:
    - field: EquilEscoRefPanel.refMajorRadius
      file: jetto.jset
    - field: RMJ
      file: jetto.in
      section: NLIST1
```
